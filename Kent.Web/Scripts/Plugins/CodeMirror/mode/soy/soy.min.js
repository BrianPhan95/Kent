(function(n){typeof exports=="object"&&typeof module=="object"?n(require("../../lib/codemirror"),require("../htmlmixed/htmlmixed")):typeof define=="function"&&define.amd?define(["../../lib/codemirror","../htmlmixed/htmlmixed"],n):n(CodeMirror)})(function(n){"use strict";var t=["template","literal","msg","fallbackmsg","let","if","elseif","else","switch","case","default","foreach","ifempty","for","call","param","deltemplate","delcall","log"];n.defineMode("soy",function(i){function u(n){return n[n.length-1]}function e(n,t,i){var r=n.string,u=i.exec(r.substr(n.pos)),f;return u&&(n.string=r.substr(0,n.pos+u.index)),f=n.hideFirstChars(t.indent,function(){return t.localMode.token(n,t.localState)}),n.string=r,f}var f=n.getMode(i,"text/plain"),r={html:n.getMode(i,{name:"text/html",multilineTagIndentFactor:2,multilineTagIndentPastTag:!1}),attributes:f,text:f,uri:f,css:n.getMode(i,"text/css"),js:n.getMode(i,{name:"text/javascript",statementIndent:2*i.indentUnit})};return{startState:function(){return{kind:[],kindTag:[],soyState:[],indent:0,localMode:r.html,localState:n.startState(r.html)}},copyState:function(t){return{tag:t.tag,kind:t.kind.concat([]),kindTag:t.kindTag.concat([]),soyState:t.soyState.concat([]),indent:t.indent,localMode:t.localMode,localState:n.copyState(t.localMode,t.localState)}},token:function(f,o){var s,h;switch(u(o.soyState)){case"comment":return f.match(/^.*?\*\//)?o.soyState.pop():f.skipToEnd(),"comment";case"variable":return f.match(/^}/)?(o.indent-=2*i.indentUnit,o.soyState.pop(),"variable-2"):(f.next(),null);case"tag":return f.match(/^\/?}/)?(o.tag=="/template"||o.tag=="/deltemplate"?o.indent=0:o.indent-=(f.current()=="/}"||t.indexOf(o.tag)==-1?2:1)*i.indentUnit,o.soyState.pop(),"keyword"):f.match(/^([\w?]+)(?==)/)?(f.current()=="kind"&&(s=f.match(/^="([^"]+)/,!1))&&(h=s[1],o.kind.push(h),o.kindTag.push(o.tag),o.localMode=r[h]||r.html,o.localState=n.startState(o.localMode)),"attribute"):f.match(/^"/)?(o.soyState.push("string"),"string"):(f.next(),null);case"literal":return f.match(/^(?=\{\/literal})/)?(o.indent-=i.indentUnit,o.soyState.pop(),this.token(f,o)):e(f,o,/\{\/literal}/);case"string":return f.match(/^.*?"/)?o.soyState.pop():f.skipToEnd(),"string"}return f.match(/^\/\*/)?(o.soyState.push("comment"),"comment"):f.match(f.sol()?/^\s*\/\/.*/:/^\s+\/\/.*/)?"comment":f.match(/^\{\$[\w?]*/)?(o.indent+=2*i.indentUnit,o.soyState.push("variable"),"variable-2"):f.match(/^\{literal}/)?(o.indent+=i.indentUnit,o.soyState.push("literal"),"keyword"):(s=f.match(/^\{([\/@\\]?[\w?]*)/))?(s[1]!="/switch"&&(o.indent+=(/^(\/|(else|elseif|case|default)$)/.test(s[1])&&o.tag!="switch"?1:2)*i.indentUnit),o.tag=s[1],o.tag=="/"+u(o.kindTag)&&(o.kind.pop(),o.kindTag.pop(),o.localMode=r[u(o.kind)]||r.html,o.localState=n.startState(o.localMode)),o.soyState.push("tag"),"keyword"):e(f,o,/\{|\s+\/\/|\/\*/)},indent:function(t,r){var f=t.indent,e=u(t.soyState);if(e=="comment")return n.Pass;if(e=="literal")/^\{\/literal}/.test(r)&&(f-=i.indentUnit);else{if(/^\s*\{\/(template|deltemplate)\b/.test(r))return 0;/^\{(\/|(fallbackmsg|elseif|else|ifempty)\b)/.test(r)&&(f-=i.indentUnit);t.tag!="switch"&&/^\{(case|default)\b/.test(r)&&(f-=i.indentUnit);/^\{\/switch\b/.test(r)&&(f-=i.indentUnit)}return f&&t.localMode.indent&&(f+=t.localMode.indent(t.localState,r)),f},innerMode:function(n){return n.soyState.length&&u(n.soyState)!="literal"?null:{state:n.localState,mode:n.localMode}},electricInput:/^\s*\{(\/|\/template|\/deltemplate|\/switch|fallbackmsg|elseif|else|case|default|ifempty|\/literal\})$/,lineComment:"//",blockCommentStart:"/*",blockCommentEnd:"*/",blockCommentContinue:" * ",fold:"indent"}},"htmlmixed");n.registerHelper("hintWords","soy",t.concat(["delpackage","namespace","alias","print","css","debugger"]));n.defineMIME("text/x-soy","soy")});
//# sourceMappingURL=soy.min.js.map
