(function(n){typeof exports=="object"&&typeof module=="object"?n(require("../../lib/codemirror"),require("../python/python"),require("../stex/stex"),require("../../addon/mode/overlay")):typeof define=="function"&&define.amd?define(["../../lib/codemirror","../python/python","../stex/stex","../../addon/mode/overlay"],n):n(CodeMirror)})(function(n){"use strict";n.defineMode("rst",function(t,i){var r=/^\*\*[^\*\s](?:[^\*]*[^\*\s])?\*\*/,u=/^\*[^\*\s](?:[^\*]*[^\*\s])?\*/,f=/^``[^`\s](?:[^`]*[^`\s])``/,e=/^(?:[\d]+(?:[\.,]\d+)*)/,o=/^(?:\s\+[\d]+(?:[\.,]\d+)*)/,s=/^(?:\s\-[\d]+(?:[\.,]\d+)*)/,h=new RegExp("^[Hh][Tt][Tt][Pp][Ss]?://(?:[\\d\\w.-]+)\\.(?:\\w{2,6})(?:/[\\d\\w\\#\\%\\&\\-\\.\\,\\/\\:\\=\\?\\~]+)*"),c={token:function(n){if(n.match(r)&&n.match(/\W+|$/,!1))return"strong";if(n.match(u)&&n.match(/\W+|$/,!1))return"em";if(n.match(f)&&n.match(/\W+|$/,!1))return"string-2";if(n.match(e))return"number";if(n.match(o))return"positive";if(n.match(s))return"negative";if(n.match(h))return"link";while(n.next()!=null){if(n.match(r,!1))break;if(n.match(u,!1))break;if(n.match(f,!1))break;if(n.match(e,!1))break;if(n.match(o,!1))break;if(n.match(s,!1))break;if(n.match(h,!1))break}return null}},l=n.getMode(t,i.backdrop||"rst-base");return n.overlayMode(l,c,!0)},"python","stex");n.defineMode("rst-base",function(t){function f(n){var t=Array.prototype.slice.call(arguments,1);return n.replace(/{(\d+)}/g,function(n,i){return typeof t[i]!="undefined"?t[i]:n})}function r(t,f){var e=null;if(t.sol()&&t.match(fi,!1))i(f,ot,{mode:k,local:n.startState(k)});else if(t.sol()&&t.match(lt))i(f,s),e="meta";else if(t.sol()&&t.match(ct))i(f,r),e="header";else if(a(f)==h||t.match(h,!1))switch(l(f)){case 0:i(f,r,u(h,1));t.match(/^:/);e="meta";break;case 1:i(f,r,u(h,2));t.match(ut);e="keyword";t.current().match(/^(?:math|latex)/)&&(f.tmp_stex=!0);break;case 2:i(f,r,u(h,3));t.match(/^:`/);e="meta";break;case 3:if(f.tmp_stex&&(f.tmp_stex=undefined,f.tmp={mode:d,local:n.startState(d)}),f.tmp){if(t.peek()=="`"){i(f,r,u(h,4));f.tmp=undefined;break}e=f.tmp.mode.token(t,f.tmp.local);break}i(f,r,u(h,4));t.match(et);e="string";break;case 4:i(f,r,u(h,5));t.match(/^`/);e="meta";break;case 5:i(f,r,u(h,6));t.match(rt);break;default:i(f,r)}else if(a(f)==c||t.match(c,!1))switch(l(f)){case 0:i(f,r,u(c,1));t.match(/^`/);e="meta";break;case 1:i(f,r,u(c,2));t.match(et);e="string";break;case 2:i(f,r,u(c,3));t.match(/^`:/);e="meta";break;case 3:i(f,r,u(c,4));t.match(ut);e="keyword";break;case 4:i(f,r,u(c,5));t.match(/^:/);e="meta";break;case 5:i(f,r,u(c,6));t.match(rt);break;default:i(f,r)}else if(a(f)==p||t.match(p,!1))switch(l(f)){case 0:i(f,r,u(p,1));t.match(/^:/);e="meta";break;case 1:i(f,r,u(p,2));t.match(ut);e="keyword";break;case 2:i(f,r,u(p,3));t.match(/^:/);e="meta";break;case 3:i(f,r,u(p,4));t.match(rt);break;default:i(f,r)}else if(a(f)==tt||t.match(tt,!1))switch(l(f)){case 0:i(f,r,u(tt,1));t.match(st);e="variable-2";break;case 1:i(f,r,u(tt,2));t.match(/^_?_?/)&&(e="link");break;default:i(f,r)}else if(t.match(yt))i(f,r),e="quote";else if(t.match(pt))i(f,r),e="quote";else if(t.match(wt))i(f,r),(!t.peek()||t.peek().match(/^\W$/))&&(e="link");else if(a(f)==v||t.match(v,!1))switch(l(f)){case 0:!t.peek()||t.peek().match(/^\W$/)?i(f,r,u(v,1)):t.match(v);break;case 1:i(f,r,u(v,2));t.match(/^`/);e="link";break;case 2:i(f,r,u(v,3));t.match(et);break;case 3:i(f,r,u(v,4));t.match(/^`_/);e="link";break;default:i(f,r)}else t.match(ui)?i(f,oi):t.next()&&i(f,r);return e}function s(t,f){var e=null;if(a(f)==y||t.match(y,!1))switch(l(f)){case 0:i(f,s,u(y,1));t.match(st);e="variable-2";break;case 1:i(f,s,u(y,2));t.match(dt);break;case 2:i(f,s,u(y,3));t.match(gt);e="keyword";break;case 3:i(f,s,u(y,4));t.match(ni);e="meta";break;default:i(f,r)}else if(a(f)==b||t.match(b,!1))switch(l(f)){case 0:i(f,s,u(b,1));t.match(bt);e="keyword";t.current().match(/^(?:math|latex)/)?f.tmp_stex=!0:t.current().match(/^python/)&&(f.tmp_py=!0);break;case 1:i(f,s,u(b,2));t.match(kt);e="meta";(t.match(/^latex\s*$/)||f.tmp_stex)&&(f.tmp_stex=undefined,i(f,ot,{mode:d,local:n.startState(d)}));break;case 2:i(f,s,u(b,3));(t.match(/^python\s*$/)||f.tmp_py)&&(f.tmp_py=undefined,i(f,ot,{mode:k,local:n.startState(k)}));break;default:i(f,r)}else if(a(f)==nt||t.match(nt,!1))switch(l(f)){case 0:i(f,s,u(nt,1));t.match(ti);t.match(ii);e="link";break;case 1:i(f,s,u(nt,2));t.match(ri);e="meta";break;default:i(f,r)}else t.match(at)?(i(f,r),e="quote"):t.match(vt)?(i(f,r),e="quote"):(t.eatSpace(),t.eol()?i(f,r):(t.skipToEnd(),i(f,ei),e="comment"));return e}function ei(n,t){return ht(n,t,"comment")}function oi(n,t){return ht(n,t,"meta")}function ht(n,t,u){return n.eol()||n.eatSpace()?(n.skipToEnd(),u):(i(t,r),null)}function ot(n,t){return t.ctx.mode&&t.ctx.local?n.sol()?(n.eatSpace()||i(t,r),null):t.ctx.mode.token(n,t.ctx.local):(i(t,r),null)}function u(n,t,i,r){return{phase:n,stage:t,mode:i,local:r}}function i(n,t,i){n.tok=t;n.ctx=i||{}}function l(n){return n.ctx.stage||0}function a(n){return n.ctx.phase}var k=n.getMode(t,"python"),d=n.getMode(t,"stex"),it="\\s+",e="(?:\\s*|\\W|$)",rt=new RegExp(f("^{0}",e)),w="(?:[^\\W\\d_](?:[\\w!\"#$%&'()\\*\\+,\\-\\./:;<=>\\?]*[^\\W_])?)",ut=new RegExp(f("^{0}",w)),o=f("(?:{0}|`{1}`)",w,"(?:[^\\W\\d_](?:[\\w\\s!\"#$%&'()\\*\\+,\\-\\./:;<=>\\?]*[^\\W_])?)"),ft="(?:[^\\s\\|](?:[^\\|]*[^\\s\\|])?)",g="(?:[^\\`]+)",et=new RegExp(f("^{0}",g)),ct=new RegExp("^([!'#$%&\"()*+,-./:;<=>?@\\[\\\\\\]^_`{|}~])\\1{3,}\\s*$"),lt=new RegExp(f("^\\.\\.{0}",it)),nt=new RegExp(f("^_{0}:{1}|^__:{1}",o,e)),b=new RegExp(f("^{0}::{1}",o,e)),y=new RegExp(f("^\\|{0}\\|{1}{2}::{3}",ft,it,o,e)),at=new RegExp(f("^\\[(?:\\d+|#{0}?|\\*)]{1}",o,e)),vt=new RegExp(f("^\\[{0}\\]{1}",o,e)),tt=new RegExp(f("^\\|{0}\\|",ft)),yt=new RegExp(f("^\\[(?:\\d+|#{0}?|\\*)]_",o)),pt=new RegExp(f("^\\[{0}\\]_",o)),wt=new RegExp(f("^{0}__?",o)),v=new RegExp(f("^`{0}`_",g)),h=new RegExp(f("^:{0}:`{1}`{2}",w,g,e)),c=new RegExp(f("^`{1}`:{0}:{2}",w,g,e)),p=new RegExp(f("^:{0}:{1}",w,e)),bt=new RegExp(f("^{0}",o)),kt=new RegExp(f("^::{0}",e)),st=new RegExp(f("^\\|{0}\\|",ft)),dt=new RegExp(f("^{0}",it)),gt=new RegExp(f("^{0}",o)),ni=new RegExp(f("^::{0}",e)),ti=new RegExp("^_"),ii=new RegExp(f("^{0}|_",o)),ri=new RegExp(f("^:{0}",e)),ui=new RegExp("^::\\s*$"),fi=new RegExp("^\\s+(?:>>>|In \\[\\d+\\]:)\\s");return{startState:function(){return{tok:r,ctx:u(undefined,0)}},copyState:function(t){var i=t.ctx,r=t.tmp;return i.local&&(i={mode:i.mode,local:n.copyState(i.mode,i.local)}),r&&(r={mode:r.mode,local:n.copyState(r.mode,r.local)}),{tok:t.tok,ctx:i,tmp:r}},innerMode:function(n){return n.tmp?{state:n.tmp.local,mode:n.tmp.mode}:n.ctx.mode?{state:n.ctx.local,mode:n.ctx.mode}:null},token:function(n,t){return t.tok(n,t)}}},"python","stex");n.defineMIME("text/x-rst","rst")});
//# sourceMappingURL=rst.min.js.map
