(function(n){typeof exports=="object"&&typeof module=="object"?n(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)})(function(n){"use strict";function h(t,i){function u(t){if(!r.parentNode)return n.off(document,"mousemove",u);r.style.top=Math.max(0,t.clientY-r.offsetHeight-5)+"px";r.style.left=t.clientX+5+"px"}var r=document.createElement("div");r.className="CodeMirror-lint-tooltip";r.appendChild(i.cloneNode(!0));document.body.appendChild(r);n.on(document,"mousemove",u);return u(t),r.style.opacity!=null&&(r.style.opacity=1),r}function r(n){n.parentNode&&n.parentNode.removeChild(n)}function c(n){n.parentNode&&(n.style.opacity==null&&r(n),n.style.opacity=0,setTimeout(function(){r(n)},600))}function u(t,i,r){function f(){n.off(r,"mouseout",f);u&&(c(u),u=null)}var u=h(t,i),e=setInterval(function(){if(u)for(var n=r;;n=n.parentNode){if(n&&n.nodeType==11&&(n=n.host),n==document.body)return;if(!n){f();break}}if(!u)return clearInterval(e)},400);n.on(r,"mouseout",f)}function l(n,t,i){this.marked=[];this.options=t;this.timeout=null;this.hasGutter=i;this.onMouseOver=function(t){k(n,t)};this.waitingFor=0}function a(n,t){return t instanceof Function?{getAnnotations:t}:(t&&t!==!0||(t={}),t)}function f(n){var i=n.state.lint,r;for(i.hasGutter&&n.clearGutter(t),r=0;r<i.marked.length;++r)i.marked[r].clear();i.marked.length=0}function v(t,i,r,f){var e=document.createElement("div"),o=e;if(e.className="CodeMirror-lint-marker-"+i,r&&(o=e.appendChild(document.createElement("div")),o.className="CodeMirror-lint-marker-multiple"),f!=!1)n.on(o,"mouseover",function(n){u(n,t,o)});return e}function y(n,t){return n=="error"?n:t}function p(n){for(var r,u,t=[],i=0;i<n.length;++i)r=n[i],u=r.from.line,(t[u]||(t[u]=[])).push(r);return t}function e(n){var i=n.severity,t;return i||(i="error"),t=document.createElement("div"),t.className="CodeMirror-lint-message-"+i,t.appendChild(document.createTextNode(n.message)),t}function w(t,i,r){function u(){e=-1;t.off("change",u)}var f=t.state.lint,e=++f.waitingFor;t.on("change",u);i(t.getValue(),function(i,r){(t.off("change",u),f.waitingFor==e)&&(r&&i instanceof n&&(i=r),o(t,i))},r,t)}function i(t){var f=t.state.lint,i=f.options,u=i.options||i,r=i.getAnnotations||t.getHelper(n.Pos(0,0),"lint");r&&(i.async||r.async?w(t,r,u):o(t,r(t.getValue(),u,t)))}function o(n,i){var o,s,l,b,a,r,h;f(n);var u=n.state.lint,c=u.options,w=p(i);for(o=0;o<w.length;++o)if(s=w[o],s){for(l=null,b=u.hasGutter&&document.createDocumentFragment(),a=0;a<s.length;++a)r=s[a],h=r.severity,h||(h="error"),l=y(l,h),c.formatAnnotation&&(r=c.formatAnnotation(r)),u.hasGutter&&b.appendChild(e(r)),r.to&&u.marked.push(n.markText(r.from,r.to,{className:"CodeMirror-lint-mark-"+h,__annotation:r}));u.hasGutter&&n.setGutterMarker(o,t,v(b,l,s.length>1,u.options.tooltips))}if(c.onUpdateLinting)c.onUpdateLinting(i,w,n)}function s(n){var t=n.state.lint;t&&(clearTimeout(t.timeout),t.timeout=setTimeout(function(){i(n)},t.options.delay||500))}function b(n,t){var i=t.target||t.srcElement;u(t,e(n),i)}function k(n,t){var f=t.target||t.srcElement,r,u;if(/\bCodeMirror-lint-mark-/.test(f.className)){var i=f.getBoundingClientRect(),o=(i.left+i.right)/2,s=(i.top+i.bottom)/2,e=n.findMarksAt(n.coordsChar({left:o,top:s},"client"));for(r=0;r<e.length;++r)if(u=e[r].__annotation,u)return b(u,t)}}var t="CodeMirror-lint-markers";n.defineOption("lint",!1,function(r,u,e){var c,v,o,h;if(e&&e!=n.Init&&(f(r),r.state.lint.options.lintOnChange!==!1&&r.off("change",s),n.off(r.getWrapperElement(),"mouseover",r.state.lint.onMouseOver),clearTimeout(r.state.lint.timeout),delete r.state.lint),u){for(c=r.getOption("gutters"),v=!1,o=0;o<c.length;++o)c[o]==t&&(v=!0);if(h=r.state.lint=new l(r,a(r,u),v),h.options.lintOnChange!==!1)r.on("change",s);if(h.options.tooltips!=!1)n.on(r.getWrapperElement(),"mouseover",h.onMouseOver);i(r)}});n.defineExtension("performLint",function(){this.state.lint&&i(this)})});
//# sourceMappingURL=lint.min.js.map
